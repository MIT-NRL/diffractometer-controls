<?xml version="1.0" standalone="no" ?>
<hdf5_layout>
  <global name="detector_data_destination" ndattribute="HDF5FrameLocation" />
    <group name="exchange">
      <dataset name="frame_type" source="ndattribute" ndattribute="FrameType" when="OnFileClose" />       
      <dataset name="data" source="detector">
        <!-- SaveDest = 0 : /exchange/data -->
        <attribute name="description" source="constant" value="ImageData" type="string" />
        <!-- <attribute name="axes" source="constant" value="theta:y:x" type="string" /> -->
        <attribute name="units" source="constant" value="counts" type="string" />
        <attribute name="angle" source="ndattribute" value="SampleTheta" type="string" />
      </dataset>
      <dataset name="data_dark" source="detector">
        <!-- SaveDest = 1 : /exchange/data_dark -->
        <attribute name="description" source="constant" value="DarkData" type="string" />
        <!-- <attribute name="axes" source="constant" value="theta:y:x" type="string" /> -->
        <attribute name="units" source="constant" value="counts" type="string" />
      </dataset>
      <dataset name="data_white" source="detector">
        <!-- SaveDest = 2 : /exchange/data_white -->
        <attribute name="description" source="constant" value="WhiteData" type="string" />
        <!-- <attribute name="axes" source="constant" value="theta:y:x" type="string" /> -->
        <attribute name="units" source="constant" value="counts" type="string" />
      </dataset>
      <dataset name="theta" source="ndattribute" ndattribute="SampleTheta" when="OnFileClose">
        <attribute name="units" source="constant" value="degrees" type="string" />
        <attribute name="description" source="constant" value="computed rotation stage angle" type="string" />
      </dataset>
      <!-- theta: 
            after the file is written, Python will add this new dataset
            the values will be the (computed) rotation angles for images in data
            
            Looks like this:
                theta:float64[1500] = [0.0, 0.12008005336891261, 0.24016010673782523, '...', 180.0]
                  @units = degrees
                  @description = computed rotation stage angle
      -->
    </group><!-- /exchange -->
    
    <group name="measurement">
      <group name="instrument">
        <dataset name="name" source="constant" value="4DH4 tomography beamline" type="string" when="OnFileClose" />   
             
        <group name="source">
          <dataset name="beamline" source="constant" value="4DH4" type="string" when="OnFileClose" />        
          <dataset name="name" source="constant" value="Massachusetts Institute of Technology Reactor" type="string" when="OnFileClose" />        
          <dataset name="reactor power" source="ndattribute" ndattribute="ReactorPower" when="OnFileClose">        
            <attribute name="units" source="constant" value="MW" type="string" />
          </dataset>    
        </group><!-- /source -->
        
        <group name="detector">
          <dataset name="manufacturer" source="ndattribute" ndattribute="DetectorManufacturer" when="OnFileClose" />
          <dataset name="model" source="ndattribute" ndattribute="DetectorModel" when="OnFileClose" />
          <dataset name="serial_number" source="ndattribute" ndattribute="SerialNumber" when="OnFileClose" />
          <dataset name="firmware_version" source="ndattribute" ndattribute="FirmwareVersion" when="OnFileClose" />
          <dataset name="SDK_version" source="ndattribute" ndattribute="SDKVersion" when="OnFileClose" />
          <dataset name="driver_version" source="ndattribute" ndattribute="DriverVersion" when="OnFileClose" />
          <dataset name="ADcore_version" source="ndattribute" ndattribute="ADCoreVersion" when="OnFileClose" />
          <dataset name="HDFplugin_version" source="ndattribute" ndattribute="HDFPluginVersion" when="OnFileClose" />

          <dataset name="dimension_x" source="ndattribute" ndattribute="MaxSizeX" when="OnFileClose" />
          <dataset name="dimension_y" source="ndattribute" ndattribute="MaxSizeY" when="OnFileClose" />
          <dataset name="gain" source="ndattribute" ndattribute="Gain" when="OnFileClose" />          
          <dataset name="gain_auto" source="ndattribute" ndattribute="GainAuto" when="OnFileClose" />          
          <dataset name="binning_x" source="ndattribute" ndattribute="BinX" when="OnFileClose" />
          <dataset name="binning_y" source="ndattribute" ndattribute="BinY" when="OnFileClose" />
          <dataset name="frame_rate" source="ndattribute" ndattribute="FrameRate" when="OnFileClose" /> 
          <dataset name="frame_rate_enable" source="ndattribute" ndattribute="FrameRateEnable" when="OnFileClose" /> 
          <dataset name="exposure_time" source="ndattribute" ndattribute="AcquireTime" when="OnFileClose" />
          <dataset name="acquire_period" source="ndattribute" ndattribute="AcquirePeriod" when="OnFileClose" />
          <dataset name="pixel_format" source="ndattribute" ndattribute="PixelFormat" when="OnFileClose" />       
          <dataset name="convert_pixel_format" source="ndattribute" ndattribute="ConvertPixelFormat" when="OnFileClose" />       
          <dataset name="array_counter" source="ndattribute" ndattribute="ArrayCounter" when="OnFileClose" />       
          <dataset name="temperature" source="ndattribute" ndattribute="DetectorTemperature" when="OnFileClose">
            <attribute name="units" source="constant" value="Celsius" type="string"></attribute>
          </dataset>
          <dataset name="pixel_size" source="ndattribute" ndattribute="DetectorPixelSize" when="OnFileClose">
            <attribute name="units" source="constant" value="microns" type="string"></attribute>
          </dataset>
          <group name="roi">
            <dataset name="min_x" source="ndattribute" ndattribute="MinX" when="OnFileClose" />
            <dataset name="size_x" source="ndattribute" ndattribute="SizeX" when="OnFileClose" />
            <dataset name="min_y" source="ndattribute" ndattribute="MinY" when="OnFileClose" />
            <dataset name="size_y" source="ndattribute" ndattribute="SizeY" when="OnFileClose" />
          </group><!-- /roi -->    
        </group><!-- /detector -->

      </group><!-- /instrument -->

      <group name="sample">
        <dataset name="name" source="ndattribute" ndattribute="SampleName" when="OnFileClose" />        
        <dataset name="description_1" source="ndattribute" ndattribute="SampleDescription1" when="OnFileClose" />        
        <dataset name="description_2" source="ndattribute" ndattribute="SampleDescription2" when="OnFileClose" />        
        <dataset name="description_3" source="ndattribute" ndattribute="SampleDescription3" when="OnFileClose" />               
      </group><!-- /sample -->
    </group><!-- /measurement -->
         
    <group name="process">
      <group name="acquisition">
        <dataset name="start_date" source="ndattribute" ndattribute="DateTimeStart" when="OnFileOpen" />
        <dataset name="end_date" source="ndattribute" ndattribute="DateTimeEnd" when="OnFileClose" />
        
     </group><!-- /acquisition -->
    </group><!-- /process -->

    <group name="defaults" ndattr_default="true">
    </group><!-- /defaults -->

</hdf5_layout>